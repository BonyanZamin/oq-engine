# -*- coding: utf-8 -*-
# vim: tabstop=4 shiftwidth=4 softtabstop=4
#
# Copyright (C) 2015-2021 GEM Foundation
#
# OpenQuake is free software: you can redistribute it and/or modify it
# under the terms of the GNU Affero General Public License as published
# by the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# OpenQuake is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Affero General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with OpenQuake. If not, see <http://www.gnu.org/licenses/>.


"""
Module exports :class:`BoraEtAl2019`
"""

import numpy as np
from openquake.hazardlib.gsim.base import GMPE, CoeffsTable
from openquake.hazardlib import const
from openquake.hazardlib.imt import SA


CONSTANTS = {"r0": 1,
             "r1": 50,
             "Mh": 5.0,
             "Vc": 1100.,
             "Vref": 800.,
             "Mref": 4.5}


def _get_source_term(self, C, ctx):
    fsource = np.array(C['c3'] * (ctx.mag-CONSTANTS['Mh']) +
                       C['c2'] * (8.5 - ctx.mag)**2)
    fsource[ctx.mag <= CONSTANTS['Mh']] = (C['c1'] *
                                           (ctx.mag - CONSTANTS['Mh']) *
                                           C['c2'] * (8.5 - ctx.mag)**2)
    return fsource


def _get_finite_fault_factor(self, C, ctx):
    h = np.ones_like(ctx.mag)
    h[ctx.mag <= 4] = 2
    h[(ctx.mag > 4) & (ctx.mag <= 5)] = C['c4'] - (C['c4'] - 1)*(5 - ctx.mag)
    h[ctx.mag > 5] = C['c4']
    return h


def _get_path_term(self, C, ctx):
    t1 = np.sqrt(
        ctx.rrup**2
        + _get_finite_fault_factor(self, C, ctx)**2)
    t2 = np.sqrt(
        CONSTANTS['r1']**2
        + _get_finite_fault_factor(self, C, ctx)**2)
    m = ctx.mag - CONSTANTS['Mref']
    g = np.ones_like(ctx.rrup)
    idx = ctx.rrup <= 50
    g[idx] = (C['b1'] + C['c7']*m)*np.log(t1[idx]/CONSTANTS['r0'])
    ix = ctx.rrup > 50
    g[ix] = ((C['b1'] + C['c7']*m)*np.log(t2/CONSTANTS['r0']) +
             (C['b2'] + C['c7']*m)*np.log(t1[ix]/t2))
    fpath = g + C['c5']*(t1-CONSTANTS['r0'])
    return fpath


def _get_site_term(self, C, ctx):
    fsite = np.ones_like(ctx.vs30)
    idx = ctx.vs30 < CONSTANTS['Vc']
    fsite[idx] = C['c6']*np.log(ctx.vs30[idx]/CONSTANTS['Vref'])
    ix = ctx.vs30 >= CONSTANTS['Vc']
    fsite[ix] = C['c6']*np.log(CONSTANTS['Vc']/CONSTANTS['Vref'])
    return fsite


def _get_mean_stddevs(self, C, ctx):
    mean = C['c0'] \
           + _get_source_term(self, C, ctx) \
           + _get_path_term(self, C, ctx) \
           + _get_site_term(self, C, ctx)  # lnFAS
    phi = np.sqrt(C['phiss']**2 + C['phis2s']**2)
    tau = C['tau']
    sigma = np.sqrt(C['phiss']**2 + C['tau']**2 + C['phis2s']**2)
    return mean, sigma, tau, phi


class BoraEtAl2019(GMPE):
    """
    Implements the Fourier amplitude spectra model proposed by Bora et al.,
    2019 as described in Bora, S.S., Cotton, F., & Scherbaum, F. (2019).
    NGA-West2 empirical Fourier and duration models to generate adjustable
    response spectra.  Earthquake Spectra, 35(1), 61-93.
    """

    #: Supported tectonic region type is active shallow crust, see title!
    DEFINED_FOR_TECTONIC_REGION_TYPE = const.TRT.ACTIVE_SHALLOW_CRUST

    #: Supported intensity measure types
    DEFINED_FOR_INTENSITY_MEASURE_TYPES = {SA}

    #: Supported intensity measure component
    DEFINED_FOR_INTENSITY_MEASURE_COMPONENT = const.IMC.HORIZONTAL

    #: Supported standard deviation types
    DEFINED_FOR_STANDARD_DEVIATION_TYPES = {
        const.StdDev.TOTAL,
        const.StdDev.INTER_EVENT,
        const.StdDev.INTRA_EVENT}

    #: Required site parameters
    REQUIRES_SITES_PARAMETERS = {'vs30'}

    #: Required rupture parameters
    REQUIRES_RUPTURE_PARAMETERS = {'mag'}

    #: Required distance measures
    REQUIRES_DISTANCES = {'rrup'}

    def compute(self, ctx, imts, mean, sigma, tau, phi):
        for m, imt in enumerate(imts):
            C = self.COEFFS[imt]
            mean[m], sigma[m], tau[m], phi[m] = _get_mean_stddevs(self, C, ctx)

    TMP = """
IMT	c0	c1	c2	c3	c5	c6	c7	b1	b2	c4	tau	phis2s	phiss
FAS(0.100000)	  2.502721	 -3.019871	 -0.699490	 -0.753383	 -0.000664	 -0.447089	  0.022658	 -0.600521	 -0.616534	  4.695513	  0.588481	  0.433801	  0.618731
FAS(0.106365)	  2.493093	 -2.950991	 -0.698331	 -0.702345	 -0.000575	 -0.473010	  0.008473	 -0.558481	 -0.633469	  4.957988	  0.599289	  0.448807	  0.602762
FAS(0.113136)	  2.200098	 -2.752071	 -0.665214	 -0.538501	 -0.000352	 -0.512475	  0.001339	 -0.555658	 -0.668379	  5.483681	  0.566033	  0.466240	  0.598172
FAS(0.120337)	  2.034254	 -2.515671	 -0.635101	 -0.399333	  0.000068	 -0.559914	 -0.005287	 -0.580986	 -0.720196	  5.849424	  0.590206	  0.480868	  0.599358
FAS(0.127997)	  1.141054	 -1.603872	 -0.533125	 -0.093856	  0.000568	 -0.601643	 -0.001067	 -0.599126	 -0.807875	  5.479586	  0.619351	  0.513743	  0.595123
FAS(0.136145)	  1.097931	 -1.443322	 -0.513488	  0.000711	  0.000471	 -0.649213	 -0.007346	 -0.621231	 -0.806567	  5.655956	  0.609747	  0.547181	  0.579869
FAS(0.144811)	  1.483405	 -1.566082	 -0.524720	 -0.039643	  0.000095	 -0.685792	 -0.014701	 -0.668480	 -0.770634	  6.277618	  0.577566	  0.571830	  0.574023
FAS(0.154028)	  1.722277	 -1.532085	 -0.529630	 -0.082756	 -0.000249	 -0.729455	 -0.020042	 -0.687414	 -0.743207	  7.372563	  0.568067	  0.586442	  0.566853
FAS(0.163833)	  1.460062	 -1.045959	 -0.486672	  0.050120	  0.000080	 -0.757137	 -0.019793	 -0.721626	 -0.805302	  8.475857	  0.567493	  0.591050	  0.560264
FAS(0.174261)	  1.578707	 -0.976147	 -0.482629	  0.020787	  0.000336	 -0.788055	 -0.017830	 -0.735112	 -0.880703	  9.400856	  0.558559	  0.595600	  0.552430
FAS(0.185354)	  1.182896	 -0.585629	 -0.437618	  0.178991	 -0.000098	 -0.811826	 -0.014909	 -0.732047	 -0.856809	  9.634207	  0.551311	  0.595141	  0.542030
FAS(0.197152)	  1.028945	 -0.401910	 -0.418764	  0.249817	 -0.000102	 -0.831472	 -0.017980	 -0.723225	 -0.882838	  9.488215	  0.549276	  0.589500	  0.534848
FAS(0.209701)	  1.008199	 -0.281530	 -0.403387	  0.274326	  0.000283	 -0.857238	 -0.013728	 -0.748505	 -0.954770	  9.074102	  0.537859	  0.583164	  0.526973
FAS(0.223050)	  0.952214	 -0.100525	 -0.381330	  0.292816	  0.000465	 -0.878500	 -0.004891	 -0.779029	 -0.986529	  8.908125	  0.536849	  0.592284	  0.513298
FAS(0.237248)	  1.178575	 -0.160342	 -0.390391	  0.173209	  0.000123	 -0.904452	  0.002093	 -0.781467	 -0.961360	  8.723396	  0.513503	  0.602817	  0.507707
FAS(0.252349)	  0.708780	  0.248825	 -0.345601	  0.325379	 -0.000450	 -0.912881	  0.000958	 -0.754971	 -0.922065	  8.629659	  0.493815	  0.613269	  0.502845
FAS(0.268412)	  1.004978	  0.122071	 -0.364488	  0.230865	 -0.000864	 -0.911891	 -0.005948	 -0.734668	 -0.891612	  8.583765	  0.481502	  0.621306	  0.496708
FAS(0.285497)	  1.261065	  0.032291	 -0.375803	  0.152242	 -0.001051	 -0.915325	 -0.005031	 -0.744518	 -0.886562	  8.283252	  0.467006	  0.631639	  0.486605
FAS(0.303670)	  1.297381	  0.092339	 -0.368150	  0.123975	 -0.000851	 -0.932075	  0.000870	 -0.759433	 -0.907780	  7.922853	  0.465369	  0.637449	  0.481833
FAS(0.323000)	  1.562149	 -0.059743	 -0.379728	 -0.017064	 -0.000373	 -0.952465	  0.011775	 -0.781885	 -0.954932	  7.194634	  0.464929	  0.644506	  0.477796
FAS(0.343560)	  1.769220	 -0.211335	 -0.393160	 -0.168478	 -0.000611	 -0.975669	  0.020777	 -0.769298	 -0.936470	  6.413038	  0.475512	  0.650128	  0.471976
FAS(0.365429)	  1.890658	 -0.250480	 -0.396678	 -0.237745	 -0.001481	 -0.999728	  0.022318	 -0.759166	 -0.833777	  6.521672	  0.472458	  0.648982	  0.469486
FAS(0.388689)	  2.130684	 -0.129224	 -0.389770	 -0.134336	 -0.001106	 -1.020442	 -0.001384	 -0.828361	 -0.856439	  8.918802	  0.459027	  0.643223	  0.474265
FAS(0.413431)	  2.361291	 -0.266048	 -0.398039	 -0.235030	 -0.000864	 -1.029347	  0.005013	 -0.849435	 -0.892612	  8.863510	  0.443919	  0.641079	  0.466338
FAS(0.439747)	  2.526448	 -0.353976	 -0.400916	 -0.318871	 -0.001225	 -1.034310	  0.016244	 -0.864689	 -0.866883	  8.738875	  0.427872	  0.641956	  0.459823
FAS(0.467739)	  2.712478	 -0.424865	 -0.406352	 -0.392185	 -0.001677	 -1.045025	  0.019552	 -0.868453	 -0.821506	  9.011042	  0.407667	  0.644819	  0.449623
FAS(0.497512)	  2.612818	 -0.300818	 -0.389130	 -0.356464	 -0.001904	 -1.059898	  0.020111	 -0.866730	 -0.804309	  9.330572	  0.398756	  0.646516	  0.444090
FAS(0.529180)	  2.319697	 -0.114682	 -0.357297	 -0.283039	 -0.002276	 -1.080106	  0.028977	 -0.873672	 -0.776718	  8.836028	  0.410077	  0.646758	  0.443035
FAS(0.562864)	  2.334836	 -0.049314	 -0.346319	 -0.296059	 -0.002659	 -1.078860	  0.034577	 -0.882866	 -0.757249	  8.566388	  0.413934	  0.647490	  0.441455
FAS(0.598692)	  2.397870	  0.036465	 -0.337457	 -0.290048	 -0.003081	 -1.065418	  0.035405	 -0.897132	 -0.731072	  8.022384	  0.419604	  0.641890	  0.443353
FAS(0.636801)	  2.647084	 -0.114578	 -0.351191	 -0.353196	 -0.003370	 -1.074562	  0.032902	 -0.908839	 -0.701560	  7.623681	  0.418915	  0.637685	  0.441450
FAS(0.677336)	  2.848015	 -0.236295	 -0.360717	 -0.424204	 -0.003632	 -1.085635	  0.033817	 -0.918274	 -0.672746	  7.153077	  0.417074	  0.636162	  0.436687
FAS(0.720450)	  2.943614	 -0.323765	 -0.363214	 -0.492163	 -0.004122	 -1.072913	  0.042181	 -0.915610	 -0.636083	  6.597247	  0.409387	  0.633403	  0.435369
FAS(0.766309)	  2.912696	 -0.334542	 -0.356048	 -0.502259	 -0.004654	 -1.065519	  0.048036	 -0.913443	 -0.596760	  6.467298	  0.403888	  0.631699	  0.435413
FAS(0.815088)	  2.835456	 -0.262489	 -0.342249	 -0.479609	 -0.005298	 -1.067293	  0.050057	 -0.915190	 -0.539470	  6.199515	  0.400224	  0.632177	  0.433292
FAS(0.866971)	  2.652585	 -0.090136	 -0.315409	 -0.394593	 -0.005770	 -1.062614	  0.053942	 -0.934395	 -0.508115	  6.263060	  0.408389	  0.626972	  0.432250
FAS(0.922156)	  2.631965	 -0.020550	 -0.301798	 -0.366646	 -0.005996	 -1.058997	  0.056846	 -0.956150	 -0.501033	  6.867407	  0.403315	  0.620559	  0.431109
FAS(0.980855)	  2.616111	 -0.001736	 -0.293827	 -0.366779	 -0.006359	 -1.054700	  0.061408	 -0.962546	 -0.473458	  7.125266	  0.397365	  0.617920	  0.428982
FAS(1.043289)	  2.316386	  0.198839	 -0.263259	 -0.267677	 -0.007021	 -1.040763	  0.067259	 -0.966126	 -0.407853	  6.944848	  0.407264	  0.613528	  0.427656
FAS(1.109698)	  2.241022	  0.264157	 -0.250976	 -0.253383	 -0.007862	 -1.026116	  0.070970	 -0.964208	 -0.319211	  6.582391	  0.395521	  0.604894	  0.425915
FAS(1.180334)	  2.269478	  0.211850	 -0.251291	 -0.290285	 -0.008348	 -1.022461	  0.075176	 -0.957412	 -0.282657	  6.078868	  0.391500	  0.599434	  0.427715
FAS(1.255467)	  2.499808	  0.013730	 -0.266121	 -0.375132	 -0.008403	 -1.015690	  0.080435	 -0.972081	 -0.295963	  5.964108	  0.396227	  0.598450	  0.426733
FAS(1.335381)	  2.491482	  0.057561	 -0.254910	 -0.362719	 -0.008297	 -1.004641	  0.086904	 -0.998518	 -0.332486	  6.147740	  0.399183	  0.595224	  0.425148
FAS(1.420383)	  2.432963	  0.088293	 -0.244573	 -0.345553	 -0.008631	 -0.990512	  0.091882	 -1.005693	 -0.326305	  6.434796	  0.397523	  0.594757	  0.425027
FAS(1.510795)	  2.334815	  0.191931	 -0.230556	 -0.294290	 -0.009150	 -0.970915	  0.090699	 -1.004291	 -0.288785	  7.105801	  0.400003	  0.592036	  0.425695
FAS(1.606962)	  2.273795	  0.265674	 -0.219753	 -0.260308	 -0.009355	 -0.945864	  0.089311	 -1.003019	 -0.288782	  7.708344	  0.399659	  0.587275	  0.427449
FAS(1.709251)	  2.277332	  0.276811	 -0.216432	 -0.258176	 -0.009665	 -0.930580	  0.089909	 -1.003295	 -0.280763	  7.951065	  0.396070	  0.579032	  0.431993
FAS(1.818050)	  2.194919	  0.353264	 -0.206047	 -0.220656	 -0.009917	 -0.929168	  0.090119	 -1.007090	 -0.277264	  7.688199	  0.396331	  0.571163	  0.435441
FAS(1.933776)	  2.073759	  0.445147	 -0.192705	 -0.161339	 -0.009929	 -0.930662	  0.087187	 -1.009811	 -0.303536	  7.640645	  0.400647	  0.562001	  0.435190
FAS(10.233153)	 -0.209619	  1.072218	 -0.021111	  0.305755	 -0.016239	 -0.219503	  0.130771	 -1.074731	 -0.632261	  8.615701	  0.530335	  0.745724	  0.483583
FAS(10.884528)	 -0.590813	  1.327520	  0.006090	  0.433990	 -0.016484	 -0.190699	  0.126989	 -1.078255	 -0.631858	  8.344938	  0.539617	  0.759351	  0.492577
FAS(11.577365)	 -0.794289	  1.411860	  0.016994	  0.497851	 -0.016694	 -0.155732	  0.123958	 -1.083777	 -0.640712	  8.048460	  0.548349	  0.775077	  0.501090
FAS(12.314304)	 -0.875128	  1.419564	  0.019291	  0.533435	 -0.016657	 -0.119546	  0.119100	 -1.098543	 -0.677907	  8.063853	  0.556698	  0.794164	  0.509975
FAS(13.098151)	 -1.087532	  1.533420	  0.030969	  0.611052	 -0.016442	 -0.088442	  0.112347	 -1.108905	 -0.722907	  7.969873	  0.566131	  0.812444	  0.519800
FAS(13.931892)	 -1.328812	  1.679333	  0.042960	  0.688804	 -0.016329	 -0.074177	  0.104557	 -1.113136	 -0.751793	  7.799691	  0.575603	  0.826441	  0.531994
FAS(14.818705)	 -1.498357	  1.763035	  0.047271	  0.750288	 -0.016055	 -0.063893	  0.093012	 -1.115266	 -0.803599	  7.731392	  0.585761	  0.838268	  0.547851
FAS(15.761965)	 -1.594775	  1.804876	  0.045409	  0.793234	 -0.015567	 -0.047882	  0.078530	 -1.119253	 -0.880983	  7.798979	  0.595311	  0.850113	  0.566532
FAS(16.765268)	 -1.687226	  1.841603	  0.043181	  0.831449	 -0.015078	 -0.037133	  0.064706	 -1.127959	 -0.950957	  7.664152	  0.600040	  0.859328	  0.587097
FAS(17.832434)	 -1.733393	  1.820598	  0.036408	  0.864677	 -0.014747	 -0.043134	  0.049738	 -1.139191	 -0.993590	  7.772944	  0.605522	  0.868930	  0.606246
FAS(18.967528)	 -1.766743	  1.827728	  0.033442	  0.903539	 -0.014567	 -0.047682	  0.037750	 -1.165311	 -1.028395	  8.260293	  0.616296	  0.880365	  0.624573
FAS(2.056867)	  1.950723	  0.511381	 -0.179350	 -0.115822	 -0.010062	 -0.920703	  0.088088	 -1.013533	 -0.316145	  7.760725	  0.398098	  0.556704	  0.435871
FAS(2.187793)	  1.913676	  0.506037	 -0.173175	 -0.118144	 -0.010083	 -0.903578	  0.094099	 -1.022750	 -0.339283	  7.758897	  0.398617	  0.557406	  0.435781
FAS(2.327054)	  1.796001	  0.595645	 -0.158644	 -0.080674	 -0.010315	 -0.878033	  0.097394	 -1.027177	 -0.337960	  7.731091	  0.393595	  0.556826	  0.435258
FAS(2.475179)	  1.620285	  0.764312	 -0.138455	  0.021461	 -0.010597	 -0.852862	  0.093325	 -1.029557	 -0.339022	  8.044115	  0.392600	  0.556979	  0.437653
FAS(2.632732)	  1.627094	  0.753860	 -0.137408	  0.053171	 -0.010704	 -0.844250	  0.087954	 -1.031593	 -0.369310	  8.595811	  0.396190	  0.554588	  0.442587
FAS(2.800315)	  1.668308	  0.681330	 -0.141010	  0.020271	 -0.010973	 -0.838744	  0.090585	 -1.030957	 -0.379072	  8.649042	  0.399244	  0.553042	  0.448083
FAS(2.978564)	  1.714210	  0.587653	 -0.144912	 -0.044387	 -0.011448	 -0.828821	  0.098001	 -1.028281	 -0.361647	  8.304531	  0.399523	  0.553551	  0.452000
FAS(20.174876)	 -1.780579	  1.859324	  0.032220	  0.937435	 -0.014284	 -0.041121	  0.027635	 -1.200551	 -1.085972	  8.711638	  0.628991	  0.891406	  0.643731
FAS(21.459075)	 -1.893706	  1.902726	  0.033557	  0.984458	 -0.013871	 -0.043093	  0.016119	 -1.220211	 -1.151852	  8.893815	  0.638458	  0.903753	  0.663891
FAS(22.825018)	 -2.164515	  1.998536	  0.042546	  1.067264	 -0.013358	 -0.060097	  0.004079	 -1.229292	 -1.213588	  9.025439	  0.645358	  0.916123	  0.686062
FAS(24.277907)	 -2.569155	  2.144212	  0.058188	  1.190593	 -0.012876	 -0.078526	 -0.009654	 -1.228808	 -1.259128	  8.974260	  0.656469	  0.930474	  0.711646
FAS(25.823278)	 -2.858158	  2.272352	  0.067389	  1.314533	 -0.012052	 -0.040598	 -0.030689	 -1.225113	 -1.340043	  8.435884	  0.680050	  0.937978	  0.739612
FAS(27.467017)	 -2.910308	  2.158616	  0.052507	  1.283833	 -0.011618	 -0.032748	 -0.046469	 -1.212824	 -1.364189	  8.268536	  0.696825	  0.950490	  0.766761
FAS(29.215386)	 -2.921081	  1.994126	  0.033580	  1.195667	 -0.011218	 -0.039380	 -0.057357	 -1.205177	 -1.378796	  8.145032	  0.722729	  0.966892	  0.796593
FAS(3.168160)	  1.888434	  0.370606	 -0.160801	 -0.156172	 -0.011918	 -0.815110	  0.106644	 -1.029104	 -0.348421	  7.956270	  0.394332	  0.553380	  0.453769
FAS(3.369824)	  1.841223	  0.329694	 -0.158177	 -0.159449	 -0.012333	 -0.797525	  0.111079	 -1.030633	 -0.335554	  7.829499	  0.389563	  0.555494	  0.453567
FAS(3.584325)	  1.452248	  0.578019	 -0.126024	 -0.015423	 -0.012795	 -0.773373	  0.111379	 -1.024433	 -0.314193	  8.106267	  0.391961	  0.562393	  0.454009
FAS(3.812479)	  1.002016	  0.940987	 -0.084818	  0.165049	 -0.013348	 -0.734464	  0.112160	 -1.022283	 -0.285849	  8.441606	  0.401075	  0.570411	  0.454121
FAS(31.075044)	 -2.894234	  1.829166	  0.014356	  1.114364	 -0.010573	 -0.042152	 -0.065476	 -1.218699	 -1.432313	  8.090636	  0.741954	  0.982744	  0.825808
FAS(33.053076)	 -3.068560	  1.795817	  0.011578	  1.138236	 -0.010038	 -0.052039	 -0.072717	 -1.233329	 -1.481914	  8.077779	  0.744801	  0.999597	  0.855189
FAS(35.157016)	 -3.218203	  1.749713	  0.006998	  1.145363	 -0.009505	 -0.071322	 -0.081634	 -1.243946	 -1.525713	  8.321423	  0.756290	  1.021410	  0.883427
FAS(37.394879)	 -3.396429	  1.766781	  0.006144	  1.175931	 -0.008732	 -0.083625	 -0.094993	 -1.257295	 -1.591638	  8.777748	  0.773898	  1.049723	  0.910205
FAS(39.775190)	 -3.806549	  1.959988	  0.022934	  1.299714	 -0.008065	 -0.089601	 -0.108512	 -1.264877	 -1.641371	  9.212936	  0.792458	  1.081230	  0.937564
FAS(4.055156)	  0.934088	  0.998122	 -0.076779	  0.181126	 -0.013588	 -0.694315	  0.114045	 -1.025450	 -0.299311	  8.457871	  0.404919	  0.573886	  0.453377
FAS(4.313281)	  0.978760	  0.944301	 -0.080406	  0.157708	 -0.013627	 -0.674450	  0.111771	 -1.028179	 -0.327428	  8.584398	  0.408824	  0.580043	  0.455730
FAS(4.587835)	  0.895981	  1.012461	 -0.071841	  0.196697	 -0.013706	 -0.659240	  0.109686	 -1.033925	 -0.355237	  9.058279	  0.416914	  0.591075	  0.456809
FAS(4.879867)	  0.738707	  1.128371	 -0.057437	  0.247991	 -0.013776	 -0.633938	  0.111992	 -1.039127	 -0.398739	  9.436983	  0.425450	  0.601326	  0.456187
FAS(42.307015)	 -4.201143	  2.173735	  0.047308	  1.433505	 -0.006943	 -0.038902	 -0.117510	 -1.296483	 -1.705302	  9.900439	  0.825831	  1.075436	  0.920790
FAS(45.000000)	 -4.200409	  1.863642	  0.013109	  1.186467	 -0.006309	 -0.121036	 -0.088169	 -1.331613	 -1.723189	  9.846608	  0.864049	  1.123789	  0.962902
FAS(5.190487)	  0.843314	  1.001350	 -0.067765	  0.165622	 -0.013976	 -0.601122	  0.119192	 -1.041614	 -0.426150	  9.285793	  0.432091	  0.611022	  0.454473
FAS(5.520879)	  0.954445	  0.849787	 -0.079490	  0.080689	 -0.014206	 -0.555096	  0.125358	 -1.041757	 -0.445741	  8.920317	  0.441700	  0.624090	  0.452538
FAS(5.872301)	  0.847068	  0.866019	 -0.072214	  0.105089	 -0.014343	 -0.510113	  0.128364	 -1.044514	 -0.480478	  9.016769	  0.450335	  0.636131	  0.451593
FAS(6.246093)	  0.650458	  0.942742	 -0.058738	  0.160967	 -0.014527	 -0.467604	  0.129487	 -1.042373	 -0.512961	  9.064821	  0.455356	  0.642466	  0.451602
FAS(6.643678)	  0.395933	  1.084613	 -0.040379	  0.247561	 -0.014769	 -0.427798	  0.126353	 -1.039602	 -0.524216	  8.990410	  0.459311	  0.650192	  0.452811
FAS(7.066571)	  0.258102	  1.154304	 -0.030547	  0.298292	 -0.014915	 -0.401966	  0.124263	 -1.047412	 -0.542403	  9.245329	  0.460634	  0.660971	  0.453915
FAS(7.516382)	  0.236973	  1.109399	 -0.032100	  0.283024	 -0.015151	 -0.374580	  0.127293	 -1.055106	 -0.556396	  9.163345	  0.470247	  0.671505	  0.457202
FAS(7.994825)	  0.201427	  1.043350	 -0.035220	  0.262328	 -0.015408	 -0.339506	  0.130053	 -1.055343	 -0.571701	  8.829507	  0.486575	  0.682329	  0.460282
FAS(8.503723)	  0.207898	  0.937584	 -0.042630	  0.219399	 -0.015778	 -0.301438	  0.132443	 -1.052849	 -0.576775	  8.526530	  0.494631	  0.695280	  0.463065
FAS(9.045014)	  0.210092	  0.858955	 -0.047780	  0.192755	 -0.016060	 -0.265419	  0.132555	 -1.057961	 -0.582932	  8.401484	  0.503862	  0.711258	  0.469516
FAS(9.620759)	  0.099842	  0.875281	 -0.042770	  0.206748	 -0.016143	 -0.241093	  0.133255	 -1.068192	 -0.611051	  8.493483	  0.517668	  0.729220	  0.476089
"""
    COEFFS = CoeffsTable(sa_damping=5, table=TMP)
